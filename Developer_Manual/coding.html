<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Coding Guidelines for Topographica &mdash; Topographica</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.8',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/custom.js"></script>
    <link rel="shortcut icon" href="../_static/topo-favicon.ico"/>
    <link rel="top" title="Topographica" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>

<li><a href="../index.html">Home</a></li>
<li><a href="../Downloads/index.html">Downloads</a></li>
<li><a href="../Tutorials/index.html">Tutorials</a></li>
<li><a href="../User_Manual/index.html">User Manual</a></li>







      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="coding-guidelines-for-topographica">
<h1>Coding Guidelines for Topographica<a class="headerlink" href="#coding-guidelines-for-topographica" title="Permalink to this headline">¶</a></h1>
<p>This section covers general issues of how to write code to be
included in Topographica. It includes <a class="reference external" href="#python">general info on writing in
Python</a> and <a class="reference external" href="#conventions">Python-specific conventions</a>, plus
Topographica-specific conventions such as <a class="reference external" href="#naming">guidelines for naming</a>,
<a class="reference external" href="#communication">comments, documentation</a>, <a class="reference external" href="#parameters-and-bounds">parameters</a>, <a class="reference external" href="#units">numerical units</a>, and
<a class="reference external" href="#fileextensions">file extensions</a>.</p>
<div class="section" id="coding-in-python">
<span id="python"></span><h2>Coding in Python<a class="headerlink" href="#coding-in-python" title="Permalink to this headline">¶</a></h2>
<p>If you are familiar with other programming languages, but not
Python, the best place to start is to run the Python tutorial on the
<a class="reference external" href="http://docs.python.org/">docs.python.org</a> web site. On the first pass, don&#8217;t try to
memorize anything, just try to get a feel for the overall syntax and
workings of Python. Then try looking at the Topographica code. After
working with Topographica a while, it is then a good idea to revisit
the Python tutorial and go over it in more detail, trying to figure
everything out and remember it now that the basic concepts are
there.</p>
<p>For those with experience with functional programming languages like
ML, Haskell, Scheme, or Lisp, you will be pleased to find features
such as map, apply, reduce, filter, zip, and list comprehensions.
For those who aren&#8217;t familiar with any of those, it is very
important to study the &#8220;Functional Programming Tools&#8221; and &#8220;List
Comprehensions&#8221; sections of the tutorial, because we often use those
features to write concise functions that may be hard to understand
at first glance. Lisp programmers should probably check out <a class="reference external" href="http://www.norvig.com/python-lisp.html">Python
for Lisp Programmers</a> for details of differences.</p>
<p>For those with experience in Java or C++, a good (opinionated)
introduction is <a class="reference external" href="http://dirtsimple.org/2004/12/python-is-not-java.html">Python is not Java</a>, and the <a class="reference external" href="http://www.ferg.org/projects/python_java_side-by-side.html">Python and Java
Side-by-side comparison</a> may also be useful. For those without
prior experience in any programming language, you are probably
really a user, not a Topographica developer <tt class="docutils literal"><span class="pre">:-)</span></tt>, but feel free
to get started by learning Python.</p>
</div>
<div class="section" id="general-conventions">
<span id="conventions"></span><h2>General conventions<a class="headerlink" href="#general-conventions" title="Permalink to this headline">¶</a></h2>
<p>By default, the project uses the standard set of <a class="reference external" href="http://www.python.org/peps/pep-0008.html">Python coding
conventions</a> written by Guido van Rossum, Python&#8217;s author.</p>
<p>These need not be followed to the letter; they simply help resolve
differences between Topographica authors if there are disagreements.</p>
<p>One particular guideline of these that Jim does not always follow is
that he likes to use lines much longer than 80 characters, e.g. for
a string. Other differences are listed elsewhere in this file, such
as in the <a class="reference external" href="revisioncontrol.html">revision control</a> section.</p>
<p>To keep things simple and consistent, we try to use what seems to be
the most common Python names for the following concepts (as opposed
to those from C++ or Java):</p>
<dl class="docutils">
<dt>method</dt>
<dd>(not &#8216;member function&#8217; or &#8216;virtual function&#8217;)</dd>
<dt>subclass</dt>
<dd>(although &#8216;derived class&#8217; is also ok)</dd>
<dt>superclass</dt>
<dd>(although &#8216;base class&#8217; is also ok)</dd>
</dl>
<p>Typically, classes are named with InitialCapitalLetters, functions,
methods, attributes, and parameters are
lower_case_with_underscores, and filenames are
lowercasewithnounderscores.py.</p>
<p>For whitespace, the convention is to use no more than one blank line
within a function or method, two blank lines between methods, and
three between classes. The goal is to have the code making up a
function or method group visually into a single unit, and then to
have all methods and data in one class group visually into a higher
level unit. See the files in topo/base/ for examples.</p>
<p>All variable names, documentation, and comments should be in
English, using American spelling for consistency.</p>
</div>
<div class="section" id="using-consistent-names">
<span id="naming"></span><h2>Using consistent names<a class="headerlink" href="#using-consistent-names" title="Permalink to this headline">¶</a></h2>
<p>Where there are already classes defined, please use the existing
names when writing new code, documentation, variable names, user
messages, window names, and comments. (Or else change all of the old
ones to match your new version!) For instance, Topographica is based
on Sheets, so everything should call a Sheet a Sheet, not a Region,
Area, or Layer.</p>
<p>In particular, when writing user interface code, think about what
you are letting the user plot or manipulate, and ask whether that&#8217;s
one of the concepts for which we have (laboriously!) worked out a
specific term. Examples of acceptable, well-defined terms:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Sheet</span>
<span class="n">Unit</span>
<span class="n">ConnectionField</span>
<span class="n">Projection</span>
<span class="n">ProjectionSheet</span>
<span class="n">CFSheet</span>
<span class="n">GeneratorSheet</span>
<span class="n">Image</span>
<span class="n">UnitView</span>
<span class="n">Event</span>
<span class="n">EventProcessor</span>
<span class="n">Activity</span>
</pre></div>
</div>
<p>Examples of confusing, ambiguous terms to be avoided:</p>
<dl class="docutils">
<dt>region</dt>
<dd>(Sheets only sometimes correspond to neural regions like V1)</dd>
<dt>area</dt>
<dd>(Same problem as Region)</dd>
<dt>map</dt>
<dd>(Used in too many different senses)</dd>
<dt>layer</dt>
<dd>(Biology and neural-network people use it very differently)</dd>
<dt>activation</dt>
<dd>(Implies a specific stimulus, which is not always true)</dd>
<dt>receptive field</dt>
<dd>(Only valid if plotted with reference to the external world)</dd>
</dl>
<p>As discussed elsewhere under <a class="reference external" href="ood.html">general principles of object-oriented
design</a>, such undefined terms can be used in examples that bring in
concepts from the world outside of Topographica, but they are not
appropriate for variable or class names, documentation, or comments
making up the Topographica simulator itself.</p>
</div>
<div class="section" id="communication-code-documentation-and-comments">
<span id="communication"></span><h2>Communication: code, documentation, and comments<a class="headerlink" href="#communication-code-documentation-and-comments" title="Permalink to this headline">¶</a></h2>
<p>Writing Python code is similar to writing anything else: to do it
well, you need to keep your intended audience in mind. There are
three different audiences for the different types of material in a
Python source file, and thus the guidelines for each category are
different:</p>
<div class="section" id="program-code-communicating-with-the-computer-and-the-human-reader">
<h3>Program code: Communicating with the computer and the human reader<a class="headerlink" href="#program-code-communicating-with-the-computer-and-the-human-reader" title="Permalink to this headline">¶</a></h3>
<p>Program code tells the computer what to do, and needs to be written
so that it is obvious to a human being what the computer is being
told to do. This means using class, variable, function, and function
argument names that say exactly what they are, and favoring short,
clear bits of code rather than long, convoluted logic. For instance,
any function longer than about a screenful should be broken up into
more meaningful chunks that a human can understand.</p>
</div>
<div class="section" id="docstrings-communicating-with-the-user">
<h3>Docstrings: Communicating with the user<a class="headerlink" href="#docstrings-communicating-with-the-user" title="Permalink to this headline">¶</a></h3>
<p>Every file, class, function, and Parameter should have an
appropriate docstring that says what that object does. The first
line of the docstring should be a brief summary that fits into 80
columns. If there are additional lines, there should be an
intervening blank line, followed by this more detailed discussion.
For functions, the summary line should use the imperative voice, as
in <tt class="docutils literal"><span class="pre">&quot;&quot;&quot;Return</span> <span class="pre">the</span> <span class="pre">sum</span> <span class="pre">of</span> <span class="pre">all</span> <span class="pre">arguments.&quot;&quot;&quot;</span></tt>. Such
documentation is collected automatically for the online help and for
the Reference manual, and must be written from the user&#8217;s
perspective. I.e., the docstring must say how someone calling this
function, class, etc. can use it, rather than having details about
how it was implemented or its implementation history. These strings
are used to create the reference manual, and are thus extremely
important.</p>
<p>If you want to include structured text in your docstrings such as
italics, bold, bulleted or numbered lists, hyperlinks, etc., please
use the <a class="reference external" href="http://docutils.sourceforge.net/docs/user/rst/quickstart.html">ReStructuredText</a> format. That way the strings will be
interpreted correctly when we generate the reference manual.</p>
</div>
<div class="section" id="comments-communicating-with-the-human-reader">
<h3>Comments: Communicating with the human reader<a class="headerlink" href="#comments-communicating-with-the-human-reader" title="Permalink to this headline">¶</a></h3>
<p>Comments (lines starting with #) are not processed by the computer,
and are not visible to the user. Thus comments should consist of
things that you want to be visible to someone reading the file to
really understand how something is implemented. Usually such a
person will either be (a) trying to fix a bug, or (b) trying to add
a new feature. Thus the comments should be focused on what is needed
for such readers. Please do not add redundant comments that simply
describe what each statement does; the code itself documents that
already. Redundant comments add more work for the reader, because
they are usually out of date, and not necessarily accurate. Instead,
please use comments for things that are not obvious, such as the
reason a particular approach was chosen, descriptions of things that
would be nice to add but haven&#8217;t been done yet, high-level
explanations of a long section of low-level code, etc. Do not
include information relevant to the user; such things go into
docstrings.</p>
<p>To summarize, please use code, docstrings, and comments
appropriately. Any bit of information you add to a file should go
into the correct one of those three categories, and all files should
be written to be usable by all three of the different intended
audiences.</p>
</div>
</div>
<div class="section" id="parameters-and-bounds">
<h2>Parameters and bounds<a class="headerlink" href="#parameters-and-bounds" title="Permalink to this headline">¶</a></h2>
<p>When writing user-visible classes, attributes that are meant to be
user-modifiable should be of class Parameter, so that they will be
visible in the various user interfaces.</p>
<p>Parameters should have the narrowest type and tightest bounds that
would be meaningful. For instance, a parameter that can be either
true or false should be of type param.Boolean, while one that can
only have a value from 0 to 0.5 should be of type param.Number with
a hard bound of 0 to 0.5. Using the right types and bounds greatly
simplifies life for the programmer, who can reason about the code
knowing the full allowable range of the parameter, and for the user,
who can tell what values make sense to use.</p>
<p>For Parameters that might show up in a GUI, soft bounds should also
be included wherever appropriate. These bounds set the range of
sliders, etc., and are a suggested range for the Parameter. If there
are hard bounds at both ends, soft bounds are not usually needed,
but can be useful if the reasonable range of the Parameter is much
smaller than the legal range.</p>
<p>Parameters should each be documented with an appropriate docstring
passed to the constructor. The documentation should be written from
the user perspective, not the programmer&#8217;s, because it will appear
in various online and other forms of user documentation.</p>
</div>
<div class="section" id="numerical-units-in-the-user-interface">
<span id="units"></span><h2>Numerical units in the user interface<a class="headerlink" href="#numerical-units-in-the-user-interface" title="Permalink to this headline">¶</a></h2>
<p>All quantities visible to the user, such as GUI labels, parameters,
etc. must be in appropriate units that are independent of simulation
or implementation details. For instance, all coordinates and
subregions of Sheets must be in Sheet coordinates, not e.g. exposing
the row and column in the underlying matrix. Similarly, unit
specifiers should be in Sheet coordinates, selecting the nearest
appropriate unit, not row and column.</p>
<p>Appropriate units for most parameters can be determined by
considering the <a class="reference external" href="../User_Manual/space.html">continuous plane underlying the discrete units
forming the model sheet</a>, and the <a class="reference external" href="../User_Manual/time.html">continuous logical timeline
behind the discrete timesteps in the model</a>. Some parameters should
be expressed in terms of lengths in that plane, some in terms of
areas, and some in terms of volumes, rather than numbers of units,
etc. Others are expressed in terms of lengths of time, rather than
number of time steps. More information is available in <a class="reference external" href="http://nn.cs.utexas.edu/keyword?bednar:neuroinformatics04">Bednar et
al, Neuroinformatics, 2004</a>. There is usually only one correct
answer for how to specify a particular parameter, so please discuss
it with all, or at least with Jim, before picking a unit
arbitrarily.</p>
</div>
<div class="section" id="user-level-and-simulator-code-file-extensions">
<span id="fileextensions"></span><h2>User-level and simulator code file extensions<a class="headerlink" href="#user-level-and-simulator-code-file-extensions" title="Permalink to this headline">¶</a></h2>
<p>By convention, we use a file extension of .py for the Python code
making up the simulator, in the <tt class="docutils literal"><span class="pre">topo/</span></tt> subdirectory. Models and
other user-level code such as scripts and examples should use an
extension of .ty, indicating that it is a file for use with
Topographica. (Many of the .py files are general purpose, and could
be used with any Python program, but the .ty files typically require
all or most of Topographica.)</p>
<p>All .ty files should use only the publicly available classes and
functions in <tt class="docutils literal"><span class="pre">topo/</span></tt>, i.e. they should respect the
(as-yet-only-loosely-defined) Topographica API.</p>
<p>Typically, files organized around one main class will be named with
the lowercase version of that main class. E.g. sheet.py contains
class Sheet and some associated functions. Often files will include
not just one class but a superclass and several subclasses; such
files are named after the superclass. Other files contain a number
of thematically linked functions or classes, not necessarily a class
hierarchy; these should be named for the principle or theme that
relates them (as in arrayutil.py).</p>
</div>
<div class="section" id="accessing-files-and-handling-paths">
<h2>Accessing files and handling paths<a class="headerlink" href="#accessing-files-and-handling-paths" title="Permalink to this headline">¶</a></h2>
<p>There are two points to consider when referring to files or paths on
the filesystem (which you would do, for instance, to open a file).
The first is how relative paths are processed, and the second is
differences in schemes for referring to paths on different operating
systems.</p>
<div class="section" id="relative-paths">
<h3>Relative paths<a class="headerlink" href="#relative-paths" title="Permalink to this headline">¶</a></h3>
<p>While programming Topographica, you might wish to refer to a file
somewhere within the Topographica distribution. For instance, the
Topographica window icon is <tt class="docutils literal"><span class="pre">topo/tkgui/icons/topo.xbm</span></tt>. This path
is relative to the topographica base path, so
<tt class="docutils literal"><span class="pre">open('topo/tkgui/icons/topo.xbm')</span></tt> will successfully open the
file only when the topographica base path is the operating system&#8217;s
current working directory (e.g. when topographica was started from
within its own directory, and the current working directory has not
subsequently been changed).</p>
<p>To avoid this problem, simply use the functions
<tt class="docutils literal"><span class="pre">param.resolve_path()</span></tt> (to locate an existing file) or
<tt class="docutils literal"><span class="pre">param.normalize_path()</span></tt> (to prepare a path for writing). The
example above would become
<tt class="docutils literal"><span class="pre">open(resolve_path('topo/tkgui/icons/topo.xbm'))</span></tt>; to create a
file for writing, one could write
<tt class="docutils literal"><span class="pre">open(normalize_path('topo/new_file.txt'))</span></tt>. See the documentation
for the two functions for more information.</p>
</div>
<div class="section" id="operating-system-differences">
<h3>Operating system differences<a class="headerlink" href="#operating-system-differences" title="Permalink to this headline">¶</a></h3>
<p>Topographica is used on various platforms, and one of these is
Windows, which uses a different scheme for paths from the one used
by linux and OS X. For instance, the path <tt class="docutils literal"><span class="pre">topo/tkgui/</span></tt> is
<tt class="docutils literal"><span class="pre">topo\tkgui\</span></tt> on Windows. To ensure that Topographica runs on all
platforms:</p>
<ol class="arabic simple">
<li>Do not attempt to perform operations such as <tt class="docutils literal"><span class="pre">open</span></tt> on &#8216;raw&#8217;
linux-style paths. Instead, use one of the functions
<tt class="docutils literal"><span class="pre">param.normalize_path()</span></tt> or <tt class="docutils literal"><span class="pre">param.resolve_path()</span></tt> (as
described above).</li>
<li>(For Windows developers) Never use Windows-style paths within the
code: always specify paths in linux format. The above-mentioned
functions correctly convert paths from linux to Windows, but do
not handle the inverse conversion (in common with Python&#8217;s own
path-handling functions).</li>
</ol>
<p>Python itself provides a number of functions for dealing with paths
in its <a class="reference external" href="http://docs.python.org/lib/module-os.path.html">os.path</a> module. The functions above are based on those,
but facilitate the use of &#8216;search paths&#8217;, allowing users to specify
prefixes to search for relative paths.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/topo-banner7.png" alt="Logo"/>
            </a></p>
<ul class="global-toc">

<li><a href="../index.html">Home</a></li>
<li><a href="../News/index.html">News</a></li>
<li><a href="../Downloads/index.html">Downloads</a></li>
<li><a href="../Tutorials/index.html">Tutorials</a></li>
<li><a href="../User_Manual/index.html">User Manual</a></li>
<li><a href="../Reference_Manual/index.html">Reference Manual</a></li>
<li><a href="index.html">Developer Manual</a></li>
<li><a href="http://github.com/ioam/topographica">Github Source Code</a></li>
<li><a href="../Forums/index.html">Forums</a></li>
<li><a href="../Team_Members/index.html">Team Members</a></li>
<li><a href="../Future_Work/index.html">Future Work</a></li>
<li><a href="../FAQ/index.html">FAQ</a></li>
<li><a href="../Links/index.html">Links</a></li>
<li><a href="../Home/pubs.html">Publications</a></li>
<li><a href="../site_map.html">Site Map</a></li>
</ul>
<h3><a href="../index.html">Table Of Contents</a></h3>

<ul>
<li><a class="reference internal" href="#">Coding Guidelines for Topographica</a><ul>
<li><a class="reference internal" href="#coding-in-python">Coding in Python</a></li>
<li><a class="reference internal" href="#general-conventions">General conventions</a></li>
<li><a class="reference internal" href="#using-consistent-names">Using consistent names</a></li>
<li><a class="reference internal" href="#communication-code-documentation-and-comments">Communication: code, documentation, and comments</a><ul>
<li><a class="reference internal" href="#program-code-communicating-with-the-computer-and-the-human-reader">Program code: Communicating with the computer and the human reader</a></li>
<li><a class="reference internal" href="#docstrings-communicating-with-the-user">Docstrings: Communicating with the user</a></li>
<li><a class="reference internal" href="#comments-communicating-with-the-human-reader">Comments: Communicating with the human reader</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parameters-and-bounds">Parameters and bounds</a></li>
<li><a class="reference internal" href="#numerical-units-in-the-user-interface">Numerical units in the user interface</a></li>
<li><a class="reference internal" href="#user-level-and-simulator-code-file-extensions">User-level and simulator code file extensions</a></li>
<li><a class="reference internal" href="#accessing-files-and-handling-paths">Accessing files and handling paths</a><ul>
<li><a class="reference internal" href="#relative-paths">Relative paths</a></li>
<li><a class="reference internal" href="#operating-system-differences">Operating system differences</a></li>
</ul>
</li>
</ul>
</li>
</ul>


<h3>This Page</h3>
<ul class="this-page-menu">
	<li><a	href="https://github.com/ioam/topographica/edit/master/doc/Developer_Manual/coding.rst" rel="nofollow">Edit on GitHub</a></li>
    <li><a	href="http://doozy.inf.ed.ac.uk:8010/builders/topographica_docs" rel="nofollow">Rebuild docs</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>

<li><a href="../index.html">Home</a></li>
<li><a href="../Downloads/index.html">Downloads</a></li>
<li><a href="../Tutorials/index.html">Tutorials</a></li>
<li><a href="../User_Manual/index.html">User Manual</a></li>







      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, IOAM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>